# Matez Hack æ ¹å› åˆ†ææŠ¥å‘Š

## ğŸ“Š æ‰§è¡Œæ‘˜è¦
- **é¡¹ç›®**: Matez
- **æ—¥æœŸ**: 2024
- **ç½‘ç»œ**: BNB Chain (BSC)
- **æŸå¤±**: ~ $80K
- **ç±»å‹**: æ•´æ•°æˆªæ–­/ç±»å‹ä¸åŒ¹é…å¯¼è‡´çš„é›¶æˆæœ¬â€œæœ‰æ•ˆè´¨æŠ¼â€ä¸å¥–åŠ±æå–
- **çº§åˆ«**: ğŸ”´ ä¸¥é‡

## ğŸ¯ æ”»å‡»æ¦‚è§ˆ
- **æ”»å‡»è€…**: `0xd4f04374385341da7333b82b230cd223143c4d62`
- **æ”»å‡»åˆçº¦**: `0x0aD02ce1b8EB978FD8dc4abeC5bf92Dfa81Ed705`
- **å—å®³åˆçº¦ (Matez Staking Program)**: `0x326FB70eF9e70f8f4c38CFbfaF39F960A5C252fa`
- **æ”»å‡»äº¤æ˜“**: [`0x840b0dc64dbb91e8aba524f67189f639a0bc94ee9256c57d79083bb3fd46ec91`](https://bscscan.com/tx/0x840b0dc64dbb91e8aba524f67189f639a0bc94ee9256c57d79083bb3fd46ec91)

## ğŸ’» æŠ€æœ¯åˆ†æ

PoC å±•ç¤ºäº†ä½¿ç”¨ä¸€ä¸ªæå¤§æ•´æ•°ä½œä¸º `stake(amount)` çš„å…¥å‚ï¼š

```solidity
uint256 amount = 340282366920938463463374607431768211456; // 2^128
IMatez matez = IMatez(MATEZ_STAKING_PROG);
matez.register(sponsor);
matez.stake(amount);
```

æ³¨é‡ŠæŒ‡å‡ºâ€œæ•´æ•°æˆªæ–­é—®é¢˜å¯¼è‡´ä¸Šè¿°æ•°å€¼è¢«æˆªæ–­ä¸º 0â€ï¼Œä»è€Œå®ç°â€œé›¶æˆæœ¬å´è¢«ç³»ç»Ÿè®°å½•ä¸ºå·²è´¨æŠ¼å¤§é¢â€çš„æ•ˆæœï¼›éšåé€šè¿‡æ‰¹é‡åˆ›å»ºæ¨èåœ°å€ä¸è°ƒç”¨ `claim(uint40,uint40,uint256)` é¢†å–å¥–åŠ±ï¼Œå®ç°å‡­ç©ºè·åˆ©ï¼š

```solidity
for (uint256 i = 0; i < 25; i++) {
    new AttackContract(address(this), amount);
}
IMatez(MATEZ_STAKING_PROG).claim(uint40(3), uint40(1), 0);
```

æŠ€æœ¯æ ¹å› é€šå¸¸æ¥è‡ªï¼š
- å†…éƒ¨å­˜å‚¨æˆ–è®¡ç®—ä½¿ç”¨äº†è¾ƒå°ä½å®½ï¼ˆå¦‚ `uint128/uint40`ï¼‰æ¥æ”¶å¤–éƒ¨ `uint256` å…¥å‚ï¼Œå‘ç”Ÿæˆªæ–­ï¼›
- è´¨æŠ¼é¢åº¦çš„æœ‰æ•ˆæ€§åˆ¤æ–­ä¸ä»£å¸è½¬è´¦æœªç»‘å®šï¼ˆæœª `transferFrom` æ‰£æŠ¼å®é™…ä»£å¸ï¼Œæˆ–åœ¨æˆªæ–­åæœªæ£€æŸ¥ä½™é¢/é¢åº¦ï¼‰ï¼›
- æ¨è/å¥–åŠ±ç³»ç»Ÿå¯¹â€œå·²è´¨æŠ¼â€çš„åˆ¤æ–­ä»…åŸºäºè¢«æˆªæ–­åçš„è®°å½•å€¼ï¼Œæœªä¸çœŸå®èµ„é‡‘æµå…³è”ã€‚

### å½±å“è¯„ä¼°
- ç›´æ¥æŸå¤±çº¦ $80Kï¼›
- ä»»æ„æ”»å‡»è€…å¯é›¶æˆæœ¬æ³¨å†Œä¸â€œä¼ªè´¨æŠ¼â€ï¼Œæ‰¹é‡ç”Ÿæˆé‚€è¯·å¹¶é¢†å–çœŸå®ä»£å¸å¥–åŠ±ã€‚

## ğŸ¯ æ ¹æœ¬åŸå› 
ç±»å‹/ä½å®½ä¸åŒ¹é…å¯¼è‡´çš„æ•´æ•°æˆªæ–­ï¼Œä½¿ `stake(amount)` åœ¨æç«¯æ•°å€¼ä¸‹è¢«è®°å½•ä¸ºæœ‰æ•ˆä½†æœªäº§ç”ŸçœŸå®èµ„é‡‘è½¬ç§»ï¼š
- è´¨æŠ¼å…¥è´¦é€»è¾‘ç¼ºå°‘â€œé¢åº¦ä¸èµ„é‡‘æµåŸå­ç»‘å®šâ€ï¼›
- `claim`/å¥–åŠ±å‘æ”¾ä»…ä¾èµ–è¢«æˆªæ–­çš„é€»è¾‘çŠ¶æ€ï¼Œä¸æ ¡éªŒå…ˆå‰çœŸå®è´¨æŠ¼ä¸æŒä»“ã€‚

## ğŸ› ï¸ ä¿®å¤å»ºè®®
çŸ­æœŸï¼š
- ç»Ÿä¸€ä½¿ç”¨ `uint256` å¹¶åœ¨æ¥æ”¶å‰åšèŒƒå›´æ ¡éªŒï¼›
- åœ¨ stake è·¯å¾„å¼ºåˆ¶æ‰§è¡Œ `transferFrom` æˆåŠŸä¸ä½™é¢/æˆæƒé¢åº¦æ ¸å¯¹ï¼›
- åœ¨ `claim` å‰æ ¡éªŒçœŸå®è´¨æŠ¼é‡‘é¢ä¸é”å®šæœŸï¼Œæ‹’ç»é›¶æˆæœ¬è·¯å¾„ã€‚

é•¿æœŸï¼š
- å¯¹æ¨è/å¥–åŠ±æ¨¡å—è¿›è¡Œä¸å˜é‡è®¾è®¡ï¼šå¥–åŠ±å‘æ”¾ç»‘å®šçœŸå®èµ„é‡‘å¿«ç…§ï¼›
- å¢åŠ  fuzz/è¾¹ç•Œæµ‹è¯•è¦†ç›–æå¤§å€¼ã€ç±»å‹è½¬æ¢ä¸æˆªæ–­åœºæ™¯ï¼›
- å¼•å…¥å®‰å…¨å®¡è®¡ä¸é™æ€åˆ†æä»¥å‘ç°ç±»å‹ä¸åŒ¹é…é—®é¢˜ã€‚

## ğŸ”— å‚è€ƒ
- Staking Programï¼š`0x326FB70eF9e70f8f4c38CFbfaF39F960A5C252fa`
- æ”»å‡»äº¤æ˜“ï¼š`0x840b0dc6...6ec91`
- ä¿¡æ¯æ¥æºï¼š`https://x.com/TenArmorAlert/status/1859830885966905670`

---
**æŠ¥å‘Šç”Ÿæˆ**: 2025-10-12 | **ç‰ˆæœ¬**: 1.1
